@using LogOT.Application.Employees;
@using LogOT.Application.Common.Models;
@using LogOT.Application.Employees.Queries.GetEmployee;
@using Microsoft.AspNetCore.Identity;
@model List<EmployeeDTO>;
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor
@{
    var context = HttpContextAccessor.HttpContext;
    
     var userRole = context.User.FindFirst(c => c.Type == System.Security.Claims.ClaimTypes.Role).Value;

}
@{
    ViewData["Title"] = "List";
}
<style>
    .linkbutton {
        display: inline-block;
        padding: 5px 10px;
        background-color: #337ab7;
        color: #fff;
        text-decoration: none;
        border-radius: 4px;
    }

        .linkbutton:hover {
            background-color: #23527c;
        }
</style>
<table>
     @if (userRole == "Manager")
    {
        <h2 class="message">@TempData["Message"]</h2>
        <td>
            <a class="linkbutton" href="/Employee/Create">Create</a>
        </td>
       
    }
    <form action="/logout" method="post">
        <button type="submit">Đăng xuất</button>
    </form>
    <tr>
        <th>Fullname</th>
        <th>Email</th>
        <th>PhoneNumber</th>
        <th>IdentityNumber</th>
        <th>BirthDay</th>
        <th>BankAccountNumber</th>
        <th>BankAccountName</th>
        <th>BankName</th>
        <th>Experiences</th>
        <th>OvertimeLogs</th>
        <th>LeaveLogs</th>
        <th>EmployeeContracts</th>
        <th>InterviewProcesses</th>
        <th>Skill_Employees</th>
        <th>Option</th>
    </tr>

    @foreach (var item in Model)
    {
        <tr>
            <td>@item.ApplicationUser.Fullname</td>
            <td>@item.ApplicationUser.Email</td>
            <td>@item.ApplicationUser.PhoneNumber</td>
            <td>@item.IdentityNumber</td>
            <td>@item.BirthDay</td>
            <td>@item.BankAccountNumber</td>
            <td>@item.BankAccountName</td>
            <td>@item.BankName</td>
            <td>
                <a asp-controller="Experience" asp-action="Index" asp-route-id="@item.Id">Experiences</a>
            </td>
            <td>
                <a>OvertimeLogs</a>
            </td>
            <td>
                <a>LeaveLogs</a>
            </td>
            <td>
                <a>EmployeeContracts</a>
            </td>
            <td>
                <a>InterviewProcess</a>
            </td>
            <td>
                <a asp-controller="EmployeeSkill" asp-action="Index" asp-route-id="@item.Id">Skills</a>
            </td>
            @if (userRole == "Manager")
            {
                <td>
                    <a class="linkbutton" href="/Employee/Edit/@item.Id">Edit</a>
                </td>
                <td>
                    <a class="linkbutton" href="/Employee/Delete/@item.Id">Delete</a>
                </td>
            }
        </tr>
    }
</table>